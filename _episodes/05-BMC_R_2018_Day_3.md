---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 05-BMC_R_2018_Day_3.md in _episodes_rmd/
title: "Brain & Mind Centre - Introduction into R Workshop"
subtitle: "Day 3"
author: "Nicholas Ho, Richard Morris"
source: Rmd
---



[Back to homepage](https://n-ho.github.io/bmc_r_workshop_2018/)


## Data visualisation

TODO tidyverse_website.png

We'll be revisiting the todyverse for visualisation. In particular, the most popular package for plotting is `ggplot2`. In order to get the data into the shape that `ggplot2` likes (i.e. the long format), we'll be using the `tidyr` package


~~~
# load tidyverse
library(tidyverse)
~~~
{: .language-r}



~~~
── Attaching packages ────────────────────────────────── tidyverse 1.2.1 ──
~~~
{: .output}



~~~
✔ ggplot2 3.1.0     ✔ purrr   0.2.5
✔ tibble  1.4.2     ✔ dplyr   0.7.7
✔ tidyr   0.8.2     ✔ stringr 1.3.1
✔ readr   1.1.1     ✔ forcats 0.3.0
~~~
{: .output}



~~~
── Conflicts ───────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
~~~
{: .output}



~~~
# read in last lesson's data
autism.data <- read.csv(file = "data/autism_data.csv",
                        header = TRUE,
                        sep = ",",
                        na.strings = "?")

# rename the column with the typo
colnames(autism.data)[17] <- "country"

# make a new column of patient IDs called pids
new_ids <- paste( "PatientID_" , autism.data$id, sep = "")
autism.data$pids <- new_ids

# remove the patient who was 383 years old
autism.data <- autism.data[-which.max(autism.data$age), ]
~~~
{: .language-r}



![](tidyr.jpg)

There are two main functions in `tidyr`. These are `gather()` and `spread()`, and they allow for the conversion between long and wide data formats.

Wide format are more natural for human reading. This is where we have samples in rows and variables in columns. In contrast, the long format is key-value pairing for each sample and variable. This might be clearer with some examples.

## gather()
The `gather()` function transform your data from wide to long format. To do so, we need to provide `gather()` with the name of the new column where all the variable names will be presented with the `key` argument, the name of the new column where the values will be stored with teh `value` argument and the names of any columns you want to include (or exclude) in the gathering process.


~~~
autism.data %>%
  select(A1_Score, A2_Score, A3_Score, A4_Score, A5_Score, A6_Score, A7_Score, A8_Score, A9_Score, A10_Score) %>%
  gather(key = "AQ", value = "score") %>%
  head()
~~~
{: .language-r}



~~~
        AQ score
1 A1_Score     1
2 A1_Score     1
3 A1_Score     1
4 A1_Score     1
5 A1_Score     1
6 A1_Score     1
~~~
{: .output}

We can exclude certain variables from the gathering process. For example if we didn't want to gather the PatientID and also the Class/ASD variables, we can note these in the `gather()` function

~~~
autism.data %>%
  select(pids, Class.ASD, A1_Score, A2_Score, A3_Score, A4_Score, A5_Score, A6_Score, A7_Score, A8_Score, A9_Score, A10_Score) %>%
  gather(key = "AQ", value = "score", -pids, -Class.ASD) %>%
  head()
~~~
{: .language-r}



~~~
         pids Class.ASD       AQ score
1 PatientID_1        NO A1_Score     1
2 PatientID_2        NO A1_Score     1
3 PatientID_3       YES A1_Score     1
4 PatientID_4        NO A1_Score     1
5 PatientID_5        NO A1_Score     1
6 PatientID_6       YES A1_Score     1
~~~
{: .output}


## spread()
The `spread()` function transforms from long to wide format.

~~~
autism.data %>%
  select(pids, Class.ASD, A1_Score, A2_Score, A3_Score, A4_Score, A5_Score, A6_Score, A7_Score, A8_Score, A9_Score, A10_Score) %>%
  gather(key = "AQ", value = "score", -pids, -Class.ASD) -> longdata


longdata %>%
  spread(AQ, score) %>%
  head()
~~~
{: .language-r}



~~~
           pids Class.ASD A1_Score A10_Score A2_Score A3_Score A4_Score
1   PatientID_1        NO        1         0        1        1        1
2  PatientID_10       YES        1         0        1        1        1
3 PatientID_100        NO        0         0        0        0        0
4 PatientID_101        NO        0         0        1        1        0
5 PatientID_102        NO        1         0        0        0        0
6 PatientID_103        NO        1         1        0        0        0
  A5_Score A6_Score A7_Score A8_Score A9_Score
1        0        0        1        1        0
2        0        1        1        1        1
3        0        0        0        0        1
4        0        0        0        1        0
5        0        0        0        1        0
6        0        0        0        0        1
~~~
{: .output}


![](ggplot2.png)
